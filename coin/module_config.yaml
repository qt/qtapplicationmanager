version: 2
tags: ["documentation"]
accept_configuration:
  condition: and
  conditions:
    - condition: property
      property: features
      not_contains_value: Disable
    - condition: or
      conditions:
        - condition: property
          property: target.os
          not_equals_value: MacOS
        - condition: property
          property: host.arch
          not_equals_value: ARM64
    - condition: or
      conditions:
        - condition: property
          property: platformDependency.target.os
          not_equals_value: MacOS
        - condition: property
          property: platformDependency.host.arch
          not_equals_value: ARM64

instructions:
  Build:
  - type: EnvironmentVariable
    variableName: BUILD_DOCUMENTATION
    variableValue: "1"
  - type: AppendToEnvironmentVariable
    variableName: NON_QTBASE_TARGET_CMAKE_ARGS
    variableValue: " -DINPUT_hardware_id=dummyHwId -DQT_FORCE_BUILD_TOOLS=ON"
    enable_if:
      condition: property
      property: target.os
      equals_value: QNX
  - type: Group
    instructions:
        - !include "{{qt/qtbase}}/coin_module_build_template_v2.yaml"

  Test:
    - type: EnvironmentVariable
      variableName: AM_TIMEOUT_FACTOR
      variableValue: 4
    - type: EnvironmentVariable
      variableName: AM_NO_CUSTOM_LOGGING
      variableValue: 1
    - type: EnvironmentVariable
      variableName: AM_NO_CRASH_HANDLER
      variableValue: 1
    - type: Group
      instructions:
        - !include "{{qt/qtbase}}/coin_module_test_template_v3.yaml"
        - !include "{{qt/qtbase}}/coin_module_test_docs.yaml"
      disable_if:
        condition: property
        property: target.os
        in_values: ["IOS", "Android", "WebAssembly"]
